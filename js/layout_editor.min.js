<<<<<<< HEAD
function initLayoutEditor(u){u.fn.setGroupId=function(e){return this.attr("data-groupId",e),this.each(function(){var t=M(u(this));t&&(t.layoutGroupId=e)}),this},u.fn.setGridColumnSpan=function(e){return null===e?this.css("grid-column","auto / auto"):(this.css("grid-column","span {0}".format(e)),this.each(function(){var t;u(this).hasClass("spacer")?(t=u(this).prev(".gfield"),(i=M(t)).layoutSpacerGridColumnSpan=e):(i=M(u(this)))&&(i.layoutGridColumnSpan=e)})),this;var i},u.fn.getGridColumnSpan=function(){if(void 0!==this.css("gridColumnStart")){var t=parseInt(this.css("gridColumnStart").split(" ")[1]);return t=isNaN(t)&&void 0!==m?m:t}},u.fn.resizeGroup=function(t){A(t)},String.prototype.format=function(){var i=arguments;return this.replace(/{(\d+)}/g,function(t,e){return void 0!==i[e]?i[e]:t})};var r,t,n,a=u("#form_editor_fields_container"),f=u(".gform_editor"),g=u("#gform_fields"),e=u("#no-fields"),o=u("#no-fields-drop"),c=u(".editor-sidebar"),h=u(".gfield-field-action"),d=F(),p=null,l=".add-buttons button",m=getComputedStyle(g[0])["grid-template-columns"].split(" ").length,_=m/4,v=null,s=!1;function C(t,e){var i='<li data-js-field-loading-placeholder><div class="dropzone__loader"><div class="dropzone__loader-item dropzone__loader-label"></div><div class="dropzone__loader-item dropzone__loader-content"></div></div></li>';void 0!==e?0===e?u("#gform_fields").prepend(i):u("#gform_fields").children().eq(e-1).after(i):jQuery("#field_submit")?jQuery(i).insertBefore(jQuery("#field_submit")):u("#gform_fields").append(i),u("[data-js-field-loading-placeholder]").setGridColumnSpan(m),u("#form_editor_fields_container").addClass("dropzone-loader-visible"),S(u("[data-js-field-loading-placeholder]"),L(!1).data("target"),L(!1).data("where"))}function b(){u("#form_editor_fields_container").removeClass("dropzone-loader-visible"),u("[data-js-field-loading-placeholder]").remove()}function y(i){i.hasClass("ui-draggable")&&i.draggable("destroy").resizable("destroy"),i.draggable({helper:"clone",zIndex:999,handle:".gfield-drag",create:function(t,e){var i,r;H(u(this))||((r=!!(r=u(this).attr("id").replace("field_",""))&&GetFieldById(r))&&r.layoutGroupId&&!f.hasClass("gform_legacy_markup")?i=r.layoutGroupId:w(u(this),!1)||(i=w()),u(this).setGroupId(i))},start:function(t,e){g.addClass("dragging"),a.addClass("droppable"),(p=u(this)).addClass("placeholder")},drag:function(t,e){e.helper.width(p.width()).height(p.height()).setGridColumnSpan(null),helperLeft=gform.tools.isRtl()?e.position.left+e.helper.outerWidth():e.position.left,G(0,e,e.position.top,helperLeft)},stop:function(t,e){g.removeClass("dragging"),a.removeClass("droppable"),p.removeClass("placeholder"),F().removeClass("hovering"),L().data("target")&&S(p,L().data("target"),L().data("where")),L().remove(),e.helper.remove()}}).resizable({handles:"e, w",start:function(t,e){if("1"===gf_legacy.is_legacy)return i.resizable("option","minWidth",e.size.width),i.resizable("option","maxWidth",e.size.width),void alert(gf_vars.alertLegacyMode);v=null,g.addClass("resizing")},resize:function(t,e){var i,r,o,n,a,d,l,s,f;"1"!==gf_legacy.is_legacy&&(a=g.outerWidth()/m,n=(i=e.element).outerWidth(),r=Math.max(_,Math.round(n/a)),s=i.getGridColumnSpan(),o=I(w(i)),f=i,n=1===(l=(l=o).not(".spacer")).length||l.last()[0]===f[0],a=o.filter(".spacer"),l=n&&!a.length?null:i.next(),null===v&&(v=1<o.length?s+(d=l?j(l):0):m),_="gform_editor_submit_container"===e.element.data("fieldClass")?1:m/4,f=v,"gform_editor_submit_container"===i.next().data("fieldClass")?f=v-1:1<o.length&&!n&&(f=v-_),s=_,f=f,r=Math.max(s,Math.min(f,r)),u().add(e.helper).add(e.element).css("width","auto").css("left","auto").setGridColumnSpan(r),l&&(d=v-r,l.css("width","auto").setGridColumnSpan(d)),r==m||r==v?W(a):n&&!a.length&&j(o)<m&&function(t,e,i){i=u('<div class="spacer gfield"></div>').setGroupId(e).setGridColumnSpan(i);t.after(i)}(i,w(i),1))},stop:function(){"1"!==gf_legacy.is_legacy&&g.removeClass("resizing")}})}function x(t){t.on("mousedown touchstart",function(){gform.tools.trigger("gform/flyout/close-all"),u(this).attr("title","")}).draggable({helper:"clone",revert:function(){return!1},cancel:!1,appendTo:g,containment:"document",start:function(t,e){if(i(),a.addClass("droppable"),1==gf_vars.currentlyAddingField)return!1;e.helper.width(u(this).width()).height(u(this).height()),g.addClass("dragging"),(p=u(this).clone()).addClass("placeholder"),u(this).addClass("fieldPlaceholder")},drag:function(t,e){var i,r;form.fields.length&&(i=+e.position.top+e.helper.outerHeight()/2,r=+e.position.left+e.helper.outerWidth()/2,G(0,e,i,r))},stop:function(t,e){u(this).removeClass("fieldPlaceholder"),a.removeClass("droppable"),g.removeClass("dragging");var i=!1;!form.fields.length&&s?(s=!1,i=k(e.helper.data("type"))):form.fields.length&&L(!1).data("target")&&(i=k(e.helper.data("type"))),i||(L(!1).remove(),p.remove(),p=null),u(this).attr("title",u(this).attr("data-description"))}}).on("click keypress",function(){p=null})}function G(t,d,l,s){F().removeClass("hovering"),function(t,e){n=(gform.tools.isRtl()?g:a).offset().left;var i=g.offset(),r=i.top-a.offset().top,o=i.left-n,i=h.outerWidth()||null,n=-r+i,i=-o+a.outerWidth()-c.outerWidth()-i,r=-r+a.outerHeight(),o=-o;return n<e&&e<r&&o<t&&t<i}(s,l)?l<0?L().css({top:-30,left:0,height:"4px",width:g.outerWidth()}).data({where:"top",target:F().first()}):l>g.outerHeight()?"gform_editor_submit_container"!==F().last().data("field-class")&&"gform_editor_submit_container"!==F().last().prev().data("field-class")&&L().css({top:g.outerHeight()-14,left:0,height:"4px",width:g.outerWidth()}).data({where:"bottom",target:F().last()}):F().not(d.helper).not(this).each(function(){var t,e=u(this),i=e.position(),r={top:i.top,right:i.left+e.outerWidth(),bottom:i.top+e.outerHeight(),left:i.left};if(n=s,(t=l)<(a=r).bottom&&t>a.top&&n<a.right&&n>a.left){e.addClass("hovering"),H(e)&&(i=(e=e.prev()).position(),o="right");var o=function(t,e,i,r,o){var n=i.left+r/2,a=i.right-r/2,r=i.top+o/5,o=i.bottom-o/5;{if(e>i.top&&e<r)return"top";if(e<i.bottom&&o<e)return"bottom";if(t>i.left&&t<n)return"left";if(t<i.right&&a<t)return"right"}return"center"}(s,l,r,e.outerWidth(),e.outerHeight()),n=I(w(e),!1),a=n.length>=m/_;w(e)===w(d.helper)&&(a=!1);r=function(t,e){var i,r,o;if(i=w(e),o=w(t.helper),t=I(i),i===o)return!0;H(e)?e=(r=e).prev():H(e.next())&&!1!==t.index(e.next())&&(r=e.next());r=(r=r?r.getGridColumnSpan():null)?r:z(t)?m/(t.length+1):(r=e.getGridColumnSpan())/2;if(parseInt(r)<3)return!1}(d,e);if("gform_editor_submit_container"===e.data("field-class")){if(gform.tools.isRtl()&&("left"===o||"bottom"===o))return;if("right"===o||"bottom"===o)return}if("left"===o||"right"===o){if("bottom"===e.data("field-position"))return;if(!function(t,e){if(f.hasClass("gform_legacy_markup"))return!1;if(t.hasClass("gpage")||t.hasClass("gsection")||t.hasClass("gform_hidden"))return!1;if(e.hasClass("gpage")||e.hasClass("gsection")||e.hasClass("gform_hidden")||"hidden"===e.data("type"))return!1;if(e.is("button")&&-1!==u.inArray(e.val().toLowerCase(),["page","section"]))return!1;return!0}(e,p))return;if(a||!1===r)return}if(!("bottom"===o&&0<n.filter('[data-field-class="gform_editor_submit_container"]').length))switch(L().data({where:o,target:e}),o){case"left":return L().css({top:i.top,left:i.left-10,height:e.outerHeight(),width:"4px"}),!1;case"right":return L().css({top:i.top,left:i.left+e.outerWidth()+6,right:"auto",height:e.outerHeight(),width:"4px"}),!1;case"bottom":return L().css({top:i.top+e.outerHeight()+26,left:0,height:"4px",width:"100%"}),!1;case"top":return L().css({top:i.top-30,left:0,height:"4px",width:"100%"}),!1}}}):L(!1).remove()}function S(t,e,i){var r,o,n,a,d,l,s,f;e&&(e.hasClass("gform_button")||(n=w(t),d=I(a=w(e)),H(e)?e=(l=e).prev():(H(e.next())||0<e.next().filter("[data-js-field-loading-placeholder]").length)&&!1!==d.index(e.next())&&(l=e.next()),o="left"===i||"right"===i,l&&o&&(r=l.getGridColumnSpan(),W(l),d=I(a)),"top"==i?e=d.first():"bottom"==i&&(e=d.last()),l=gform.tools.isRtl()?"right":"left","top"==i||i==l?t.insertBefore(e):t.insertAfter(e),o?(r?(s=t,f=r):s=z(d)?(f=m/(d.length+1),d.add(t)):(f=(r=e.getGridColumnSpan())/2,e.add(t)),parseInt(f)==f?s.setGridColumnSpan(f):(s=Math.floor(f),f=Math.ceil(f),t.setGridColumnSpan(s),e.setGridColumnSpan(f))):(a=w(),t.setGridColumnSpan(m)),t.setGroupId(a),A(n)))}function w(t,e){var i;return i=!(i=void 0!==t?t.attr("data-groupId"):i)&&(e||void 0===e)?"xxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}):i}function I(t,e){return e||void 0===e?F().filter('[data-groupId="{0}"]'.format(t)).not(".ui-draggable-dragging"):F().filter('[data-groupId="{0}"]'.format(t)).not(".ui-draggable-dragging").not(".spacer")}function j(t){var e=0;return t.each(function(){e+=u(this).getGridColumnSpan()}),e}function z(t){if(0===t.length)return i=!0;var e=t.first().getGridColumnSpan(),i=!0;return t.each(function(){if(u(this).getGridColumnSpan()!==e)return i=!1}),i}function A(t){var e=I(t),i=m/e.length,t=e.filter(".spacer");e[0]===t[0]&&0<e.length&&W(t),e.setGridColumnSpan(i)}function Q(){SetSubmitLocation("bottom"),jQuery("#field_submit").attr("data-field-position","bottom"),jQuery('input[name="submit_location"][value="bottom"]').prop("checked",!0)}function W(t){t.setGridColumnSpan(0).remove()}function H(t){return 0<t.filter(".spacer").length}function M(t){t=t.attr("id"),t=!(!t||-1===t.indexOf("field_"))&&String(t).replace("field_","");return!!t&&GetFieldById(t)}function k(t){return StartAddField(t,Math.max(0,g.children().index(p)))}function i(){F().removeClass("field_selected"),u(".sidebar").tabs("option","active",0),HideSettings()}function F(){return g.find(".gfield")}function L(t){t=void 0===t;var e=u("#indicator");return!e.length&&t&&(e=u('<div id="indicator"></div>'),g.append(e)),e}y(d),"1"!==window.gf_legacy.is_legacy&&d.length&&(t=function(){var t=[],e=[],i=d[0].offsetTop;return d.each(function(){i===this.offsetTop||e.length&&(t.push(e),e=[]),e.push({el:this,groupId:this.dataset.groupid}),i=this.offsetTop}),t}(),n=[],t.forEach(function(t){var e,i,r=[],o=!1;t.forEach(function(t){-1!==n.indexOf(t.groupId)&&(o=!0),r.push(t.groupId)}),r.every(function(t,e,i){return t===i[0]})&&!o||(e=t,i=w(),e.forEach(function(t){u(t.el).setGroupId(i)})),n.push(t[0].groupId)})),function(){{var t;"inline"===u("#field_submit").data("field-position")&&(t=jQuery("#field_submit").prev().attr("data-groupid"),jQuery("#field_submit").setGroupId(t))}}(),x(u(l)),e.droppable({accept:l,activate:function(t,e){o.show(),u(this).addClass("ready")},over:function(){u(this).addClass("hovering"),o.addClass("hovering")},out:function(){u(this).removeClass("hovering"),o.removeClass("hovering")},drop:function(){s=!0,u(this).removeClass("hovering"),o.removeClass("hovering")},deactivate:function(){u(this).removeClass("ready")}}),a.on("click",function(){i()}),u(document).on("gform_field_added",function(t,e,i){var r=u("#field_"+i.id);null===p?(r.setGroupId(w()),"inline"==jQuery("#field_submit").data("field-position")&&Q()):(S(r,L().data("target"),L().data("where")),p.remove(),p=null),a.hasClass("form_editor_fields_no_fields")&&(a.hasClass("form_editor_no_conflict")||gform.simplebar.initializeInstance(a[0]),setTimeout(function(){o.hide(),a.removeClass("form_editor_fields_no_fields")},200)),L().remove(),y(r),"page"===i.type&&(Q(),jQuery('input[name="submit_location"][value="inline"]').prop("disabled",!0),SetFieldAccessibilityWarning("submit_location_setting","below")),0<!jQuery("#field_submit").length&&StartAddField("submit",Math.max(0,g.children().index(p)+1))}),u(document).on("gform_field_deleted",function(t,e,i){r=w(u("#field_"+i)),HasPageField()||(jQuery('input[name="submit_location"][value="inline"]').prop("disabled",!1),jQuery(".submit_location_setting").prev(".gform-alert--notice").remove())}),gform.addAction("gform_after_field_removed",function(t,e){A(r)}),gform.addAction("gform_field_duplicated",function(t,e,i,r){I(w(u("#field_"+r))).last().after(i),i.setGridColumnSpan(m).setGroupId(w()),y(i)}),gform.addAction("gform_after_refresh_field_preview",function(t){y(u("#field_"+t))}),gform.addAction("gform_form_saving_action_element_after_reload",function(t,e,i,r,o){u(i).hasClass("gfield")&&y(u('[data-js-reload="'+r+'"]')),u(i).hasClass("editor-sidebar")&&x(u(l))}),gform.addAction("gform_form_saving_action_editor_has_new_components",function(t,e,i,r,o){x(u(l))}),gform.addAction("gform_before_get_field_markup",function(t,e,i){C(0,i)}),gform.addAction("gform_after_get_field_markup",function(t,e,i){b()}),gform.addAction("gform_after_get_field_markup",function(t,e,i){y(jQuery("#field_submit"))}),gform.addAction("gform_before_field_duplicated",function(t){t=u("#field_"+t);C(0,g.children().index(t)+1)}),gform.addAction("gform_field_duplicated",function(){b()}),gform.addAction("gform_before_refresh_field_preview",function(t){jQuery("#field_"+t).addClass("loading")}),gform.addAction("gform_after_refresh_field_preview",function(t){jQuery("#field_"+t).removeClass("loading")})}initLayoutEditor(jQuery);
=======
!function(u){u.fn.setGroupId=function(t){return this.attr("data-groupId",t),this.each(function(){var e=H(u(this));e&&(e.layoutGroupId=t)}),this},u.fn.setGridColumnSpan=function(t){return null===t?this.css("grid-column","auto / auto"):(this.css("grid-column","span {0}".format(t)),this.each(function(){var e;u(this).hasClass("spacer")?(e=u(this).prev(".gfield"),(r=H(e)).layoutSpacerGridColumnSpan=t):(r=H(u(this)))&&(r.layoutGridColumnSpan=t)})),this;var r},u.fn.getGridColumnSpan=function(){var e=parseInt(this.css("gridColumnStart").split(" ")[1]);return e=isNaN(e)&&void 0!==m?m:e},String.prototype.format=function(){var r=arguments;return this.replace(/{(\d+)}/g,function(e,t){return void 0!==r[t]?r[t]:e})};var i,e,n,a=u("#form_editor_fields_container"),f=u(".gform_editor"),h=u("#gform_fields"),t=u("#no-fields"),o=u("#no-fields-drop"),g=u(".editor-sidebar"),p=u(".gfield-field-action"),d=k(),c=null,r=".add-buttons button",m=getComputedStyle(h[0])["grid-template-columns"].split(" ").length,v=m/4,_=null,l=!1;function s(e,t){var r='<li data-js-field-loading-placeholder><div class="dropzone__loader"><div class="dropzone__loader-item dropzone__loader-label"></div><div class="dropzone__loader-item dropzone__loader-content"></div></div></li>';void 0!==t?0===t?u("#gform_fields").prepend(r):u("#gform_fields").children().eq(t-1).after(r):u("#gform_fields").append(r),u("[data-js-field-loading-placeholder]").setGridColumnSpan(m),u("#form_editor_fields_container").addClass("dropzone-loader-visible"),x(u("[data-js-field-loading-placeholder]"),T(!1).data("target"),T(!1).data("where"))}function C(){u("#form_editor_fields_container").removeClass("dropzone-loader-visible"),u("[data-js-field-loading-placeholder]").remove()}function b(r){r.hasClass("ui-draggable")&&r.draggable("destroy").resizable("destroy"),r.draggable({helper:"clone",zIndex:999,handle:".gfield-drag",create:function(e,t){var r,i;A(u(this))||((i=!!(i=u(this).attr("id").replace("field_",""))&&GetFieldById(i))&&i.layoutGroupId&&!f.hasClass("gform_legacy_markup")?r=i.layoutGroupId:y(u(this),!1)||(r=y()),u(this).setGroupId(r))},start:function(e,t){h.addClass("dragging"),a.addClass("droppable"),(c=u(this)).addClass("placeholder")},drag:function(e,t){t.helper.width(c.width()).height(c.height()).setGridColumnSpan(null),helperLeft=gform.tools.isRtl()?t.position.left+t.helper.outerWidth():t.position.left,G(0,t,t.position.top,helperLeft)},stop:function(e,t){h.removeClass("dragging"),a.removeClass("droppable"),c.removeClass("placeholder"),k().removeClass("hovering"),T().data("target")&&x(c,T().data("target"),T().data("where")),T().remove(),t.helper.remove()}}).resizable({handles:"e, w",start:function(e,t){if("1"===gf_legacy.is_legacy)return r.resizable("option","minWidth",t.size.width),r.resizable("option","maxWidth",t.size.width),void alert(gf_vars.alertLegacyMode);_=null,h.addClass("resizing")},resize:function(e,t){var r,i,o,n,a,d,l,s,f;"1"!==gf_legacy.is_legacy&&(a=h.outerWidth()/m,n=(r=t.element).outerWidth(),i=Math.max(v,Math.round(n/a)),f=r.getGridColumnSpan(),o=S(y(r)),s=r,n=1===(l=(l=o).not(".spacer")).length||l.last()[0]===s[0],a=o.filter(".spacer"),l=n&&!a.length?null:r.next(),null===_&&(_=1<o.length?f+(d=l?w(l):0):m),s=v,f=_-(1<o.length&&!n?v:0),i=Math.max(s,Math.min(f,i)),u().add(t.helper).add(t.element).css("width","auto").css("left","auto").setGridColumnSpan(i),l&&(d=_-i,l.css("width","auto").setGridColumnSpan(d)),i==m||i==_?W(a):n&&!a.length&&w(o)<m&&function(e,t,r){r=u('<div class="spacer gfield"></div>').setGroupId(t).setGridColumnSpan(r);e.after(r)}(r,y(r),1))},stop:function(){"1"!==gf_legacy.is_legacy&&h.removeClass("resizing")}})}function G(e,d,l,s){k().removeClass("hovering"),function(e,t){n=(gform.tools.isRtl()?h:a).offset().left;var r=h.offset(),i=r.top-a.offset().top,o=r.left-n,r=p.outerWidth()||null,n=-i+r,r=-o+a.outerWidth()-g.outerWidth()-r,i=-i+a.outerHeight(),o=-o;return n<t&&t<i&&o<e&&e<r}(s,l)?l<0?T().css({top:-30,left:0,height:"4px",width:h.outerWidth()}).data({where:"top",target:k().first()}):l>h.outerHeight()?T().css({top:h.outerHeight()-14,left:0,height:"4px",width:h.outerWidth()}).data({where:"bottom",target:k().last()}):k().not(d.helper).not(this).each(function(){var e,t,r=u(this),i=r.position(),o={top:i.top,right:i.left+r.outerWidth(),bottom:i.top+r.outerHeight(),left:i.left};if(e=s,(t=l)<(a=o).bottom&&t>a.top&&e<a.right&&e>a.left){r.addClass("hovering"),A(r)&&(i=(r=r.prev()).position(),n="right");var n=function(e,t,r,i,o){var n=r.left+i/2,a=r.right-i/2,i=r.top+o/5,o=r.bottom-o/5;{if(t>r.top&&t<i)return"top";if(t<r.bottom&&o<t)return"bottom";if(e>r.left&&e<n)return"left";if(e<r.right&&a<e)return"right"}return"center"}(s,l,o,r.outerWidth(),r.outerHeight()),a=S(y(r),!1).length>=m/v;y(r)===y(d.helper)&&(a=!1);o=function(e,t){var r,i,o;if(r=y(t),o=y(e.helper),e=S(r),r===o)return!0;A(t)?t=(i=t).prev():A(t.next())&&!1!==e.index(t.next())&&(i=t.next());i=(i=i?i.getGridColumnSpan():null)?i:I(e)?m/(e.length+1):(i=t.getGridColumnSpan())/2;if(parseInt(i)<3)return!1}(d,r);if("left"===n||"right"===n){if(!function(e,t){if(f.hasClass("gform_legacy_markup"))return!1;if(e.hasClass("gpage")||e.hasClass("gsection")||e.hasClass("gform_hidden"))return!1;if(t.hasClass("gpage")||t.hasClass("gsection")||t.hasClass("gform_hidden")||"hidden"===t.data("type"))return!1;if(t.is("button")&&-1!==u.inArray(t.val().toLowerCase(),["page","section"]))return!1;return!0}(r,c))return;if(a||!1===o)return}switch(T().data({where:n,target:r}),n){case"left":return T().css({top:i.top,left:i.left-10,height:r.outerHeight(),width:"4px"}),!1;case"right":return T().css({top:i.top,left:i.left+r.outerWidth()+6,right:"auto",height:r.outerHeight(),width:"4px"}),!1;case"bottom":return T().css({top:i.top+r.outerHeight()+26,left:0,height:"4px",width:"100%"}),!1;case"top":return T().css({top:i.top-30,left:0,height:"4px",width:"100%"}),!1}}}):T(!1).remove()}function x(e,t,r){var i,o,n,a,d,l,s,f;t&&(n=y(e),d=S(a=y(t)),A(t)?t=(l=t).prev():(A(t.next())||0<t.next().filter("[data-js-field-loading-placeholder]").length)&&!1!==d.index(t.next())&&(l=t.next()),o="left"===r||"right"===r,l&&o&&(i=l.getGridColumnSpan(),W(l),d=S(a)),"top"==r?t=d.first():"bottom"==r&&(t=d.last()),l=gform.tools.isRtl()?"right":"left","top"==r||r==l?e.insertBefore(t):e.insertAfter(t),o?(i?(s=e,f=i):s=I(d)?(f=m/(d.length+1),d.add(e)):(f=(i=t.getGridColumnSpan())/2,t.add(e)),parseInt(f)==f?s.setGridColumnSpan(f):(s=Math.floor(f),f=Math.ceil(f),e.setGridColumnSpan(s),t.setGridColumnSpan(f))):(a=y(),e.setGridColumnSpan(m)),e.setGroupId(a),z(n))}function y(e,t){var r;return r=!(r=void 0!==e?e.attr("data-groupId"):r)&&(t||void 0===t)?"xxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}):r}function S(e,t){return t||void 0===t?k().filter('[data-groupId="{0}"]'.format(e)).not(".ui-draggable-dragging"):k().filter('[data-groupId="{0}"]'.format(e)).not(".ui-draggable-dragging").not(".spacer")}function w(e){var t=0;return e.each(function(){t+=u(this).getGridColumnSpan()}),t}function I(e){var t=e.first().getGridColumnSpan(),r=!0;return e.each(function(){if(u(this).getGridColumnSpan()!==t)return r=!1}),r}function z(e){var t=S(e),r=m/t.length,e=t.filter(".spacer");t[0]===e[0]&&0<t.length&&W(e),t.setGridColumnSpan(r)}function W(e){e.setGridColumnSpan(0).remove()}function A(e){return 0<e.filter(".spacer").length}function H(e){e=e.attr("id"),e=!(!e||-1===e.indexOf("field_"))&&String(e).replace("field_","");return!!e&&GetFieldById(e)}function M(e){return StartAddField(e,Math.max(0,h.children().index(c)))}function j(){k().removeClass("field_selected"),u(".sidebar").tabs("option","active",0),HideSettings()}function k(){return h.find(".gfield")}function T(e){e=void 0===e;var t=u("#indicator");return!t.length&&e&&(t=u('<div id="indicator"></div>'),h.append(t)),t}b(d),"1"!==window.gf_legacy.is_legacy&&d.length&&(e=function(){var e=[],t=[],r=d[0].offsetTop;return d.each(function(){r===this.offsetTop||t.length&&(e.push(t),t=[]),t.push({el:this,groupId:this.dataset.groupid}),r=this.offsetTop}),e}(),n=[],e.forEach(function(e){var t,r,i=[],o=!1;e.forEach(function(e){-1!==n.indexOf(e.groupId)&&(o=!0),i.push(e.groupId)}),i.every(function(e,t,r){return e===r[0]})&&!o||(t=e,r=y(),t.forEach(function(e){u(e.el).setGroupId(r)})),n.push(e[0].groupId)})),u(r).on("mousedown touchstart",function(){u(this).attr("title","")}).draggable({helper:"clone",revert:function(){return!1},cancel:!1,appendTo:h,containment:"document",start:function(e,t){if(j(),a.addClass("droppable"),1==gf_vars.currentlyAddingField)return!1;t.helper.width(u(this).width()).height(u(this).height()),h.addClass("dragging"),(c=u(this).clone()).addClass("placeholder"),u(this).addClass("fieldPlaceholder")},drag:function(e,t){var r,i;form.fields.length&&(r=+t.position.top+t.helper.outerHeight()/2,i=+t.position.left+t.helper.outerWidth()/2,G(0,t,r,i))},stop:function(e,t){u(this).removeClass("fieldPlaceholder"),a.removeClass("droppable"),h.removeClass("dragging");var r=!1;!form.fields.length&&l?(l=!1,r=M(t.helper.data("type"))):form.fields.length&&T(!1).data("target")&&(r=M(t.helper.data("type"))),r||(T(!1).remove(),c.remove(),c=null),u(this).attr("title",u(this).attr("data-description"))}}).on("click keypress",function(){c=null}),t.droppable({accept:r,activate:function(e,t){o.show(),u(this).addClass("ready")},over:function(){u(this).addClass("hovering"),o.addClass("hovering")},out:function(){u(this).removeClass("hovering"),o.removeClass("hovering")},drop:function(){l=!0,u(this).removeClass("hovering"),o.removeClass("hovering")},deactivate:function(){u(this).removeClass("ready")}}),a.on("click",function(){j()}),u(document).on("gform_field_added",function(e,t,r){r=u("#field_"+r.id);null===c?r.setGroupId(y()):(x(r,T().data("target"),T().data("where")),c.remove(),c=null),a.hasClass("form_editor_fields_no_fields")&&(a.hasClass("form_editor_no_conflict")||gform.simplebar.initializeInstance(a[0]),setTimeout(function(){o.hide(),a.removeClass("form_editor_fields_no_fields")},200)),T().remove(),b(r)}),u(document).on("gform_field_deleted",function(e,t,r){i=y(u("#field_"+r))}),gform.addAction("gform_after_field_removed",function(e,t){z(i)}),gform.addAction("gform_field_duplicated",function(e,t,r,i){S(y(u("#field_"+i))).last().after(r),r.setGridColumnSpan(m).setGroupId(y()),b(r)}),gform.addAction("gform_after_refresh_field_preview",function(e){b(u("#field_"+e))}),gform.addAction("gform_before_get_field_markup",function(e,t,r){s(0,r)}),gform.addAction("gform_after_get_field_markup",function(e,t,r){C()}),gform.addAction("gform_before_field_duplicated",function(e){e=u("#field_"+e);s(0,h.children().index(e)+1)}),gform.addAction("gform_field_duplicated",function(){C()}),gform.addAction("gform_before_refresh_field_preview",function(e){jQuery("#field_"+e).addClass("loading")}),gform.addAction("gform_after_refresh_field_preview",function(e){jQuery("#field_"+e).removeClass("loading")})}(jQuery);
>>>>>>> 4aca0428747c3834f131f7a7be8e9ce96716453e
